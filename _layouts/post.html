---
layout: baseof
---

<section id="content" class="pt-36 pb-10">
  <div class="container px-0 md:max-w-7xl">
    <div class="px-4">
      <h1 class="text-3xl font-bold mb-8">
        {{ page.title }}
      </h1>

      <div class="flex flex-col md:flex-row gap-1 text-base mb-6">
        <div class="w-full md:w-[190px]">Created at: <span class="font-mono">{{ page.date | date: '%Y-%m-%d' }}</span></div>
        <div class="w-full md:w-3/4">Author by: {{ page.author }}</div>
      </div>

      <div class="markdown">
        {{ content }}
      </div>
    </div>
  </div>
</section>

<script>
document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll("pre code").forEach((block) => {
    const parentWithLanguage = block.closest("[class*='language-']");
    if (parentWithLanguage?.classList.contains("language-plaintext")) return;

    // Get the original highlighted HTML
    const originalHtml = block.innerHTML;
    let lines = originalHtml.split(/\n/);
    let filenameLabel = null;

    // Extract filename from first line using textContent for plain text matching
    const plainTextFirstLine = block.textContent.split("\n")[0];
    const filenameMatch = plainTextFirstLine.match(/^!filename:(.+)$/);

    if (filenameMatch) {
      filenameLabel = filenameMatch[1].trim();
      lines.shift(); // remove filename line from HTML lines too
    }

    // Remove trailing empty line
    if (lines.length > 0 && lines[lines.length - 1].trim() === "") {
      lines.pop();
    }

    // Function to escape problematic characters in HTML content
    function fixLiquidInHtml(htmlLine) {
      // This function now just preserves what's already there
      // since we need to escape in the source Markdown, not in JavaScript
      return htmlLine;
    }

    // Check if this is a Liquid template block
    const isLiquid = parentWithLanguage?.classList.contains("language-liquid") || 
                     parentWithLanguage?.classList.contains("language-jekyll");

    // Wrap each line preserving the original highlighted HTML
    const numberedLines = lines.map((line, idx) => {
      // Apply Liquid escaping only if needed, while preserving syntax highlighting
      const processedLine = isLiquid ? fixLiquidInHtml(line) : line;

      return `<div class="line"><span class="line-number">${idx + 1}</span><span class="code-line">${processedLine}</span></div>`;
    }).join("");

    block.innerHTML = numberedLines;

    // Add filename label if present
    if (filenameLabel) {
      const filenameElem = document.createElement("div");
      filenameElem.textContent = filenameLabel;
      filenameElem.className = "font-semibold font-mono mb-2";
      block.parentElement.insertAdjacentElement("beforebegin", filenameElem);
    }
  });
});
</script>

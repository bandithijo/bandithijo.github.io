---
layout: baseof
---

<section id="content" class="pt-36 pb-10">
  <div class="container px-0 md:max-w-7xl">
    <div class="px-4">
      <h1 class="text-3xl font-bold mb-8">
        {{ page.title }}
      </h1>

      <div class="flex flex-col md:flex-row gap-1 text-base mb-6">
        <div class="w-full md:w-[190px]">Created at: <span class="font-mono">{{ page.date | date: '%Y-%m-%d' }}</span></div>
        <div class="w-full md:w-3/4">Author by: {{ page.author }}</div>
      </div>

      <div class="markdown">
        {{ content }}
      </div>

      {% assign blog_posts = site.categories.blog %}
      {% assign index = nil %}

      {% for post in blog_posts %}
        {% if post.url == page.url %}
          {% assign index = forloop.index0 %}
        {% endif %}
      {% endfor %}

      {% assign prev_post = nil %}
      {% assign next_post = nil %}

      {% if index != nil %}
        {% assign post_count = blog_posts | size %}
        {% assign last_index = post_count | minus: 1 %}

        {% if index > 0 %}
          {% assign prev_index = index | minus: 1 %}
          {% assign prev_post = blog_posts[prev_index] %}
        {% endif %}

        {% if index < last_index %}
          {% assign next_index = index | plus: 1 %}
          {% assign next_post = blog_posts[next_index] %}
        {% endif %}
      {% endif %}

      <div class="mt-20 flex flex-col md:flex-row justify-between gap-4 md:gap-8">
        {% if prev_post %}
          <div class="w-full md:w-1/2 px-3 py-2 border border-dashed border-zinc-400 rounded-lg">
            <a href="{{ prev_post.url }}">
              <div class="flex items-center justify-start">
                <div class="mr-3">&larr;</div> <div class="text-left">{{ prev_post.title }}</div>
              </div>
            </a>
          </div>
        {% else %}
          <div class="w-1/2"></div>
        {% endif %}

        {% if next_post %}
          <div class="w-full md:w-1/2 px-3 py-2 border border-dashed border-zinc-400 rounded-lg">
            <a href="{{ next_post.url }}">
              <div class="flex items-center justify-end">
                <div class="text-right">{{ next_post.title }}</div> <div class="ml-3">&rarr;</div>
              </div>
            </a>
          </div>
        {% else %}
          <div class="w-1/2"></div>
        {% endif %}
      </div>

    </div>
  </div>
</section>

<script>
document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll("pre code").forEach((block) => {
    const parentWithLanguage = block.closest("[class*='language-']");
    if (parentWithLanguage?.classList.contains("language-plaintext")) return;

    // Get the original highlighted HTML
    const originalHtml = block.innerHTML;
    let lines = originalHtml.split(/\n/);
    let filenameLabel = null;

    // Extract filename from first line using textContent for plain text matching
    const plainTextFirstLine = block.textContent.split("\n")[0];
    const filenameMatch = plainTextFirstLine.match(/^!filename:(.+)$/);

    if (filenameMatch) {
      filenameLabel = filenameMatch[1].trim();
      lines.shift(); // remove filename line from HTML lines too
    }

    // Remove trailing empty line
    if (lines.length > 0 && lines[lines.length - 1].trim() === "") {
      lines.pop();
    }

    // Function to escape problematic characters in HTML content
    function fixLiquidInHtml(htmlLine) {
      // This function now just preserves what's already there
      // since we need to escape in the source Markdown, not in JavaScript
      return htmlLine;
    }

    // Check if this is a Liquid template block
    const isLiquid = parentWithLanguage?.classList.contains("language-liquid") || 
                     parentWithLanguage?.classList.contains("language-jekyll");

    // Wrap each line preserving the original highlighted HTML
    const numberedLines = lines.map((line, idx) => {
      // Apply Liquid escaping only if needed, while preserving syntax highlighting
      const processedLine = isLiquid ? fixLiquidInHtml(line) : line;

      return `<div class="line"><span class="line-number">${idx + 1}</span><span class="code-line">${processedLine}</span></div>`;
    }).join("");

    block.innerHTML = numberedLines;

    // Add filename label if present
    if (filenameLabel) {
      const filenameElem = document.createElement("div");
      filenameElem.textContent = filenameLabel;
      filenameElem.className = "font-semibold font-mono mb-2";
      block.parentElement.insertAdjacentElement("beforebegin", filenameElem);
    }
  });
});
</script>
